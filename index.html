<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>All-in-One Pro Tool</title>
<script src="https://unpkg.com/html5-qrcode"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
<script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
<style>body{font-family:Sarabun,sans-serif;background-color:#2c3e50;color:#333;margin:0;padding:20px;display:flex;flex-direction:column;align-items:center}.container{background:#fff;padding:30px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,.3);text-align:center;width:95%;max-width:900px}.upload-area{border:3px dashed #bdc3c7;padding:20px;margin:20px 0;border-radius:10px;cursor:pointer;background-color:#ecf0f1;transition:.3s}.upload-area:hover{border-color:#3498db;background-color:#e8f6fc}#res-a{margin-top:20px;padding:15px;border-radius:8px;display:none;word-break:break-all;text-align:left}.success{background-color:#d4edda;color:#155724;border:1px solid #c3e6cb}.error{background-color:#f8d7da;color:#721c24;border:1px solid #f5c6cb}#pdf-c{display:none;margin-top:20px;padding:15px;background:#f8f9fa;border-radius:8px;border:1px solid #ddd;align-items:center;flex-wrap:wrap;gap:10px;justify-content:center}input[type=text]{padding:8px;border:1px solid #ccc;border-radius:4px;width:150px;text-align:center}#pdf-p{display:flex;flex-wrap:wrap;gap:15px;justify-content:center;margin-top:20px}.page-card{position:relative;border:2px solid #ddd;border-radius:8px;overflow:hidden;width:140px;background:#fff;cursor:pointer}.page-card.selected{border-color:#28a745;background-color:#e9f7ef}.page-thumb{width:100%;height:auto;display:block}.p-cb{position:absolute;top:5px;left:5px;width:20px;height:20px;z-index:10}.btn{padding:10px 20px;border:none;border-radius:5px;cursor:pointer;color:#fff;transition:.2s}.btn-p{background-color:#3498db}.btn-s{background-color:#28a745}.btn-g{background-color:#6c757d}</style>
</head>
<body>
<div class="container">
    <h2>All-in-One Reader & Splitter</h2>
    <div class="upload-area" id="d-z" onclick="document.getElementById('f-i').click()">
        <p>üìÇ <b>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</b> (PDF ‡∏´‡∏£‡∏∑‡∏≠ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û)<br>‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î Ctrl+V ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏á</p>
    </div>
    <input type="file" id="f-i" accept="image/*,application/pdf" style="display:none">
    <div id="res-a"></div>
    <div id="pdf-c">
        <input type="text" id="p-r" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1-3, 5">
        <button class="btn btn-p" onclick="_applyR()">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏∏</button>
        <button class="btn btn-g" onclick="_sel(true)">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
        <button class="btn btn-g" onclick="_sel(false)">‡∏•‡πâ‡∏≤‡∏á</button>
        <button class="btn btn-s" onclick="_dl()">‚¨áÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF</button>
    </div>
    <div id="pdf-p"></div>
</div>
<script>
(function(){pdfjsLib.GlobalWorkerOptions.workerSrc='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';const {PDFDocument:_PD}=PDFLib,_qr=new Html5Qrcode("d-z"),_ra=document.getElementById('res-a'),_pp=document.getElementById('pdf-p'),_pc=document.getElementById('pdf-c');let _b=null,_tp=0;const _sc=(f)=>{_ra.style.display='block';_ra.innerHTML="‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô QR Code...";_ra.className='';_qr.scanFileV2(f,!0).then(r=>{const t=r.decodedText;let h=`‚úÖ <b>‡∏≠‡πà‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</b><br>`;try{new URL(t);h+=`<a href="${t}" target="_blank">üîó ‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå: ${t}</a>`}catch(e){h+=`‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°: <b>${t}</b>`}_ra.innerHTML=h;_ra.className='success'}).catch(e=>{_ra.innerHTML="‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö QR Code";_ra.className='error'})};const _hP=async(f)=>{_ra.style.display='none';_pp.innerHTML="‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...";_pc.style.display='none';try{_b=await f.arrayBuffer();const p=await pdfjsLib.getDocument(_b).promise;_tp=p.numPages;_pp.innerHTML="";_pc.style.display='flex';for(let i=1;i<=_tp;i++){const pg=await p.getPage(i),v=pg.getViewport({scale:.5}),c=document.createElement('canvas'),ctx=c.getContext('2d');c.height=v.height;c.width=v.width;await pg.render({canvasContext:ctx,viewport:v}).promise;const cd=document.createElement('div');cd.className='page-card';cd.dataset.n=i;cd.onclick=(e)=>{if(e.target.type!=='checkbox'){const cb=cd.querySelector('.p-cb');cb.checked=!cb.checked;_tS(cd,cb.checked)}};const cb=document.createElement('input');cb.type='checkbox';cb.className='p-cb';cb.value=i;cb.onchange=()=>_tS(cd,cb.checked);const img=document.createElement('img');img.src=c.toDataURL();img.className='page-thumb';const lb=document.createElement('div');lb.innerText=`‡∏´‡∏ô‡πâ‡∏≤ ${i}`;cd.append(cb,img,lb);_pp.appendChild(cd)}}catch(e){alert("Error PDF")}};const _tS=(c,s)=>s?c.classList.add('selected'):c.classList.remove('selected');window._applyR=()=>{const v=document.getElementById('p-r').value;_sel(!1);v.split(',').forEach(p=>{p=p.trim();if(p.includes('-')){const[s,e]=p.split('-').map(Number);for(let i=s;i<=e;i++)_ck(i)}else _ck(Number(p))})};const _ck=(n)=>{if(n<1||n>_tp)return;const c=document.querySelector(`.page-card[data-n="${n}"]`);if(c){const cb=c.querySelector('.p-cb');cb.checked=!0;_tS(c,!0)}};window._sel=(s)=>{document.querySelectorAll('.p-cb').forEach(c=>{c.checked=s;_tS(c.parentElement,s)})};window._dl=async()=>{const cs=document.querySelectorAll('.p-cb:checked');if(!cs.length)return alert("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô");const ns=Array.from(cs).map(c=>parseInt(c.value)),od=await _PD.load(_b),nd=await _PD.create();const cp=await nd.copyPages(od,ns.map(n=>n-1));cp.forEach(p=>nd.addPage(p));const nb=await nd.save(),bl=new Blob([nb],{type:'application/pdf'}),l=document.createElement('a');l.href=URL.createObjectURL(bl);l.download=`split_${Date.now()}.pdf`;l.click()};const _hF=(f)=>{if(!f)return;f.type==="application/pdf"?_hP(f):_sc(f)};document.getElementById('f-i').onchange=e=>_hF(e.target.files[0]);document.onpaste=e=>{const it=(e.clipboardData||e.originalEvent.clipboardData).items;for(let i of it)if(i.kind==='file')_hF(i.getAsFile())}})();
</script>
</body>
</html>
